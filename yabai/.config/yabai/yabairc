#!/usr/bin/env sh

# yabai configuration
# SIP-enabled mode (no scripting additions required)

# Global settings
yabai -m config layout                       bsp
yabai -m config window_placement             second_child

# Gaps and padding (matching AeroSpace 5px)
yabai -m config top_padding                  5
yabai -m config bottom_padding               5
yabai -m config left_padding                 5
yabai -m config right_padding                5
yabai -m config window_gap                   5

# Mouse settings
yabai -m config mouse_follows_focus          off
yabai -m config focus_follows_mouse          off
yabai -m config mouse_modifier               fn
yabai -m config mouse_action1                move
yabai -m config mouse_action2                resize
yabai -m config mouse_drop_action            swap

# Window settings
yabai -m config window_opacity               off
yabai -m config window_shadow                on
yabai -m config split_ratio                  0.50
yabai -m config auto_balance                 off

# ============================================
# Window rules - float system dialogs
# ============================================

yabai -m rule --add app="^System Preferences$" manage=off
yabai -m rule --add app="^System Settings$" manage=off
yabai -m rule --add app="^Calculator$" manage=off
yabai -m rule --add app="^Karabiner-Elements$" manage=off
yabai -m rule --add app="^Archive Utility$" manage=off
yabai -m rule --add app="^Finder$" title="(Co(py|nnect)|Move|Info|Pref)" manage=off
yabai -m rule --add app="^Preview$" manage=off
yabai -m rule --add app="^Activity Monitor$" manage=off
yabai -m rule --add app="^App Store$" manage=off
yabai -m rule --add app="^Digital Color Meter$" manage=off
yabai -m rule --add app="^Font Book$" manage=off
yabai -m rule --add app="^Disk Utility$" manage=off
yabai -m rule --add app="^KeyboardCleanTool$" manage=off
yabai -m rule --add app="^Raycast$" manage=off
yabai -m rule --add app="^1Password$" manage=off

# ============================================
# App-to-space rules
# Space assignments (matching AeroSpace config):
#   1: Main/default
#   2: Calendar (C)
#   3: Web/Browser (W)
#   4: Issues/Jira (I)
#   5: Music (M)
#   6: Notion (N)
#   7: Slack (S)
#   8: Terminal (T)
# ============================================

yabai -m rule --add app="^Calendar$" space=2
yabai -m rule --add app="^Fantastical$" space=2

yabai -m rule --add app="^Safari$" space=3
yabai -m rule --add app="^Google Chrome$" space=3
yabai -m rule --add app="^Firefox$" space=3
yabai -m rule --add app="^Arc$" space=3

yabai -m rule --add app="^Jira$" space=4
yabai -m rule --add app="^Linear$" space=4

yabai -m rule --add app="^Music$" space=5
yabai -m rule --add app="^Spotify$" space=5

yabai -m rule --add app="^Notion$" space=6

yabai -m rule --add app="^Slack$" space=7

yabai -m rule --add app="^Terminal$" space=8
yabai -m rule --add app="^iTerm2$" space=8
yabai -m rule --add app="^Alacritty$" space=8
yabai -m rule --add app="^kitty$" space=8
yabai -m rule --add app="^WezTerm$" space=8
yabai -m rule --add app="^Ghostty$" space=8

# Space labels (for reference - used by setup script)
# These don't affect behavior, just documentation
yabai -m space 1 --label main
yabai -m space 2 --label calendar
yabai -m space 3 --label web
yabai -m space 4 --label issues
yabai -m space 5 --label music
yabai -m space 6 --label notion
yabai -m space 7 --label slack
yabai -m space 8 --label terminal

echo "yabai configuration loaded"
